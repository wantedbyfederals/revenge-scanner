<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Revenge Scanner | Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;700;900&display=swap');

:root {
--bg-deep: #08080a;
--panel-bg: #0d0d10;
--accent: #ff4141;
--glass-border: rgba(255, 255, 255, 0.05);
}

body {
background: var(--bg-deep);
color: #e2e8f0;
font-family: 'Inter', sans-serif;
overflow: hidden;
height: 100vh;
}

.sidebar {
background: #050507;
border-right: 1px solid var(--glass-border);
width: 280px;
}

.glass-card {
background: var(--panel-bg);
border: 1px solid var(--glass-border);
border-radius: 12px;
}

.pin-card {
cursor: pointer;
transition: all 0.3s ease;
background: linear-gradient(145deg, #121217 0%, #0a0a0c 100%);
border: 1px solid var(--glass-border);
position: relative;
overflow: hidden;
border-left: 4px solid var(--accent);
}

.pin-card:hover {
border-color: var(--accent);
transform: translateY(-3px);
box-shadow: 0 10px 20px rgba(0,0,0,0.4);
}

.finding-entry {
background: #0f0f13;
border-left: 3px solid var(--accent);
border-radius: 8px;
padding: 18px;
display: flex;
flex-direction: column;
justify-content: space-between;
box-shadow: 0 6px 25px rgba(0,0,0,0.35);
min-height: 120px;
transition: all 0.2s ease;
}

.finding-entry:hover {
transform: translateY(-3px);
}

#findings-container {
height: 380px;
max-height: 380px;
overflow-y: auto;
padding: 20px;
padding-right: 10px;
border: 1px solid var(--glass-border);
border-radius: 12px;
background: rgba(0,0,0,0.25);
}

.recent-table-container {
height: 250px;
max-height: 250px;
overflow-y: auto;
}

.custom-scrollbar::-webkit-scrollbar {
width: 6px;
}
.custom-scrollbar::-webkit-scrollbar-thumb {
background: #ffffff;
border-radius: 10px;
}
.custom-scrollbar::-webkit-scrollbar-track {
background: #0a0a0d;
}

::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-thumb { background: #ffffff; border-radius: 10px; }

.hw-label {
font-family: 'JetBrains Mono', monospace;
color: #64748b;
font-size: 10px;
text-transform: uppercase;
letter-spacing: 1px;
display: flex;
align-items: center;
gap: 8px;
}

.hw-value {
color: #fff;
font-weight: 700;
font-size: 13px;
margin-top: 3px;
}

.cat-item {
display: flex;
align-items: center;
justify-content: space-between;
padding: 12px 16px;
border-radius: 8px;
background: rgba(255,255,255,0.02);
transition: all 0.2s;
cursor: pointer;
border: 1px solid transparent;
margin-bottom: 8px;
}

.cat-item:hover { background: rgba(255,255,255,0.05); }
.cat-item.active {
background: rgba(255,255,255,0.05);
border-color: rgba(255,255,255,0.1);
}

.cat-name {
color: #ffffff;
font-weight: 700;
font-size: 12px;
text-transform: uppercase;
letter-spacing: 0.5px;
}

.cat-badge {
font-family: 'JetBrains Mono', monospace;
font-size: 11px;
font-weight: 900;
padding: 2px 8px;
border-radius: 4px;
background: rgba(0,0,0,0.4);
}

.btn-action {
font-weight: 900;
font-size: 11px;
letter-spacing: 1.5px;
text-transform: uppercase;
transition: all 0.2s;
}

#auth-screen {
background: radial-gradient(circle at center, #1a1010 0%, #08080a 100%);
display: flex;
align-items: center;
justify-content: center;
position: fixed;
inset: 0;
z-index: 9999;
}

.hidden { display: none !important; }

.table-row-hover:hover {
background: rgba(255, 65, 65, 0.05);
}
</style>
</head>

<body class="flex">

<div id="auth-screen">
<div class="w-full max-w-md p-10 glass-card border-red-500/20 text-center">
<div class="w-16 h-16 bg-red-600 rounded-lg flex items-center justify-center mx-auto mb-8 shadow-[0_0_30px_rgba(255,65,65,0.3)]">
<i class="fa fa-shield-halved text-white text-3xl"></i>
</div>
<h2 class="text-3xl font-black italic mb-2 uppercase tracking-tighter text-white">Access Locked</h2>
<p class="text-gray-500 text-[10px] font-bold uppercase tracking-[0.3em] mb-10">ADMIN PANEL Verification</p>
<div class="space-y-4">
<input type="text" id="op-id" placeholder="OPERATOR ID" class="w-full bg-black/50 border border-white/10 p-4 rounded-xl text-xs font-mono focus:border-red-500 outline-none text-white">
<input type="password" id="op-key" placeholder="ACCESS KEY" class="w-full bg-black/50 border border-white/10 p-4 rounded-xl text-xs font-mono focus:border-red-500 outline-none text-white">
<input type="text" id="op-otp" placeholder="DISCORD OTP" class="w-full bg-black/50 border border-red-500/20 p-4 rounded-xl text-xs font-mono focus:border-red-500 outline-none text-red-500">
<div class="flex gap-2">
<button onclick="requestOTP()" class="w-1/3 btn-action bg-white/5 text-gray-400 p-4 rounded-xl hover:bg-white/10 text-[9px]">Send Code</button>
<button onclick="login()" class="w-2/3 btn-action bg-red-600 text-white p-4 rounded-xl hover:bg-red-500 shadow-2xl transition">Establish Connection</button>
</div>
</div>
</div>
</div>

<aside id="sidebar-ui" class="sidebar p-8 flex flex-col hidden">
<div class="flex items-center gap-3 mb-16">
<div class="w-10 h-10 bg-red-600 rounded flex items-center justify-center"><i class="fa fa-crosshairs text-white text-xl"></i></div>
<div>
<div class="font-black text-xl tracking-tighter leading-none text-white">REVENGE</div>
<div class="text-[9px] text-gray-500 font-bold tracking-[0.2em] uppercase">ADMIN PANEL</div>
</div>
</div>

<nav class="flex-1 space-y-2">
<button onclick="abortSession()" class="w-full flex items-center gap-4 px-4 py-3 rounded-xl bg-white/5 text-sm font-bold hover:bg-white/10 transition">
<i class="fa fa-th-large text-red-500"></i> SCANS DATABASE
</button>
<button onclick="manageUsers()" class="w-full flex items-center gap-4 px-4 py-3 rounded-xl text-gray-500 text-sm font-bold hover:bg-white/10 transition">
<i class="fa fa-users-cog"></i> User Management
</button>
</nav>

<div class="mt-auto pt-8 border-t border-white/5">
<div class="flex items-center gap-3 mb-4">
<div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
<span class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Network Active</span>
</div>
<button onclick="logout()" class="text-[9px] font-black text-gray-600 uppercase hover:text-red-500 transition">Terminate Session</button>
</div>
</aside>

<main id="main-ui" class="flex-1 overflow-y-auto p-12 hidden custom-scrollbar">
<div id="view-list">
<div class="flex justify-between items-center mb-12">
<div>
<h1 class="text-4xl font-black italic tracking-tight text-white">SCANS DATABASE</h1>
<p class="text-gray-500 text-xs font-bold uppercase mt-2">Real-time Terminal Monitoring</p>
</div>
<div class="flex items-center gap-4">
<div class="relative group">
  <div class="absolute -inset-0.5 bg-gradient-to-r from-red-600/30 via-red-500/20 to-purple-600/30 rounded-xl blur-sm"></div>
  <div class="relative flex items-center bg-black/90 border border-red-500/30 rounded-xl overflow-hidden group hover:border-red-500/60 transition-all duration-300 shadow-lg shadow-red-500/20">
    <div class="pl-4 pr-3 border-r border-red-500/20">
      <div class="w-5 h-5 flex items-center justify-center">
        <i class="fa fa-search text-red-400 text-xs group-hover:text-red-300 transition-colors duration-300"></i>
      </div>
    </div>
    <input type="text" id="scan-search" onkeyup="filterPins()" placeholder="SEARCH PC, PIN OR DATE..." 
    class="flex-1 bg-transparent py-4 px-4 text-[10px] font-mono outline-none text-white placeholder-red-400/60 group-hover:placeholder-red-400/80 transition-all duration-300">
    <div class="px-3 py-2 border-l border-red-500/20 bg-gradient-to-r from-red-600/10 to-purple-600/10">
      <div class="w-6 h-6 rounded-full bg-gradient-to-r from-red-500/80 to-purple-500/80 flex items-center justify-center transition-all duration-300 group-hover:scale-110">
        <i class="fa fa-terminal text-white text-[8px]"></i>
      </div>
    </div>
  </div>
  <div class="absolute -bottom-0.5 left-4 right-4 h-px bg-gradient-to-r from-red-500/30 via-red-500/60 to-purple-500/30"></div>
</div>
<button onclick="generatePIN()" class="btn-action bg-white text-black px-8 py-4 rounded-xl hover:bg-red-600 hover:text-white shadow-2xl">
GENERATE PIN
</button>
</div>
</div>
<div id="pins-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
</div>

<div id="view-detail" class="hidden">
<div class="flex justify-between items-center mb-6">
<button onclick="abortSession()" class="flex items-center gap-3 text-xs font-black uppercase text-gray-500 hover:text-white transition">
<i class="fa fa-chevron-left"></i> Return
</button>
<button onclick="deleteCurrentScan()" class="px-6 py-2 border border-red-500/20 text-red-500 rounded-lg text-xs font-black uppercase hover:bg-red-500 hover:text-white transition">
Delete Scan
</button>
</div>
<div id="report-content" class="grid grid-cols-12 gap-8"></div>
</div>
</main>

<script>
const DB_URL = "https://revengescanner-default-rtdb.firebaseio.com";
const WEBHOOK = "https://discord.com/api/webhooks/1476109273569431725/IvdnhbroUp8VRnsU29xb9lDu1Oea5ba_D6573DZOuZKAYY4nodqdZGLLz69wx0KZA_py";

let activeOTP = null;
let openPin = null;
let currentFindings = [];

function updateRoute(pinId = null) {
const path = pinId ? `/dashboard/pins/${pinId}` : '/dashboard/scans';
window.history.pushState({ pinId }, '', path);
}

window.onpopstate = (event) => {
if (event.state && event.state.pinId) {
openReport(event.state.pinId, false);
} else {
abortSession(false);
}
};

async function requestOTP() {
activeOTP = Math.floor(100000 + Math.random() * 900000).toString();
await fetch(WEBHOOK, {
method: 'POST',
headers: {'Content-Type': 'application/json'},
body: JSON.stringify({
embeds:[{
title:"üîê REVENGE AUTH",
fields:[{name:"OTP", value:`**${activeOTP}**`}],
color:16727873
}]
})
});
alert("Code sent.");
}

function login() {
if (
document.getElementById('op-id').value === "admin" &&
document.getElementById('op-key').value === "wantedbyfederals0800!" &&
document.getElementById('op-otp').value === activeOTP
) {
localStorage.setItem('auth_status', 'granted');
showMainUI();
} else {
alert("ACCESS DENIED: INVALID CREDENTIALS");
}
}

function showMainUI() {
document.getElementById('auth-screen').classList.add('hidden');
document.getElementById('sidebar-ui').classList.remove('hidden');
document.getElementById('main-ui').classList.remove('hidden');

const urlParams = window.location.pathname.split('/');
const pinIndex = urlParams.indexOf('pins');

if (pinIndex !== -1 && urlParams[pinIndex + 1]) {
openReport(urlParams[pinIndex + 1], false);
} else {
loadPins();
}
}

async function loadPins() {
const res = await fetch(`${DB_URL}/pins.json`);
const data = await res.json();
const grid = document.getElementById('pins-grid');
grid.innerHTML = "";

for (let pin in data) {
grid.innerHTML += `
<div onclick="openReport('${pin}')" class="pin-card p-8 rounded-xl">
<div class="flex justify-between items-center mb-4">
<span class="text-[11px] font-bold text-red-500 font-mono tracking-[0.2em] uppercase">
PIN #${pin}
</span>
<div class="w-2 h-2 rounded-full bg-red-600 shadow-[0_0_8px_#ff4141]"></div>
</div>
<h3 class="font-black text-2xl italic uppercase tracking-tighter text-white">
${data[pin].pcName || "INITIALIZING..."}
</h3>
<p class="text-[10px] text-gray-500 font-bold uppercase mt-2 tracking-widest opacity-60">
${data[pin].timestamp}
</p>
</div>`;
}
}

function filterPins() {
const input = document.getElementById('scan-search').value.toUpperCase();
const cards = document.querySelectorAll('.pin-card');

cards.forEach(card => {
const text = card.textContent || card.innerText;
if (text.toUpperCase().indexOf(input) > -1) {
card.style.display = "";
} else {
card.style.display = "none";
}
});
}

function renderFindings(filter) {
const container = document.getElementById('findings-grid');
const filtered = (currentFindings || []).filter(f => f.category === filter || (filter === 'Critical' && !f.category));

if (filtered.length === 0) {
container.innerHTML = `
<div class="col-span-full py-16 flex flex-col items-center justify-center opacity-20 border-2 border-dashed border-white/5 rounded-2xl">
<i class="fa fa-folder-open text-4xl mb-4"></i>
<span class="text-sm font-black uppercase italic tracking-[0.3em]">No records found</span>
</div>`;
return;
}

container.innerHTML = filtered.map(f => {
    let colorClass = "bg-red-600/20 text-red-500 border-red-500/20";
    let borderStyle = "border-left-color: #ff4141";
    let categoryName = "CRITICAL";

    if(f.category === 'Warning') {
        colorClass = "bg-orange-600/20 text-orange-500 border-orange-500/20";
        borderStyle = "border-left-color: #f97316";
        categoryName = "WARNING";
    } else if(f.category === 'Suspicious') {
        colorClass = "bg-yellow-400/20 text-yellow-400 border-yellow-400/20";
        borderStyle = "border-left-color: #facc15";
        categoryName = "SUSPICIOUS";
    } else if(f.category === 'Unsigned Files') {
        colorClass = "bg-purple-600/20 text-purple-500 border-purple-500/20";
        borderStyle = "border-left-color: #a855f7";
        categoryName = "UNSIGNED";
    }

    return `
    <div class="finding-entry" style="${borderStyle}">
        <div class="flex justify-between items-start mb-2">
            <h4 class="text-[11px] font-black uppercase tracking-tight text-white">${f.title}</h4>
            <span class="text-[8px] ${colorClass} px-1.5 py-0.5 rounded font-black uppercase border">${categoryName}</span>
        </div>
        <p class="text-[10px] text-gray-400 font-mono italic break-all">
            ${f.detail}
        </p>
    </div>`;
}).join('');
}

function filterRecentTable() {
const input = document.getElementById('recent-search');
const filter = input.value.toUpperCase();
const rows = document.querySelectorAll('.recent-row');

rows.forEach(row => {
const text = row.textContent || row.innerText;
if (text.toUpperCase().indexOf(filter) > -1) {
row.style.display = "";
} else {
row.style.display = "none";
}
});
}

async function openReport(pin, push = true) {
openPin = pin;
if (push) updateRoute(pin);

const res = await fetch(`${DB_URL}/pins/${pin}.json`);
const data = await res.json();
if (!data) { abortSession(); return; }

const specs = data.specs || {};
currentFindings = data.findings?.findings || [];
const recentData = data.recentActivity || [];

const counts = {
critical: currentFindings.filter(f => !f.category || f.category === 'Critical').length,
warning: currentFindings.filter(f => f.category === 'Warning').length,
suspicious: currentFindings.filter(f => f.category === 'Suspicious').length,
unsigned: currentFindings.filter(f => f.category === 'Unsigned Files').length
};

let resultStatus = "LEGIT";
let resultColor = "text-green-500";
let resultBg = "bg-green-500/10";
let resultIcon = "fa-shield-check";

if (counts.critical > 0) {
    resultStatus = "CHEATING";
    resultColor = "text-red-500";
    resultBg = "bg-red-500/10";
    resultIcon = "fa-shield-virus";
} else if (counts.warning > 0 || counts.suspicious > 0 || counts.unsigned > 0) {
    resultStatus = "SUSPICIOUS";
    resultColor = "text-orange-500";
    resultBg = "bg-orange-500/10";
    resultIcon = "fa-shield-exclamation";
}

let scanDate = data.timestamp ? data.timestamp.split(',')[0] : '--';

document.getElementById('report-content').innerHTML = `
<div class="col-span-12 lg:col-span-4 space-y-6">

<div class="glass-card px-6 py-4 border border-white/5 flex justify-between items-center">
    <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-full bg-purple-500/10 flex items-center justify-center text-purple-500">
            <i class="fa fa-key text-[10px]"></i>
        </div>
        <div>
            <div class="text-[8px] text-gray-500 font-bold uppercase tracking-[0.2em]">PIN</div>
            <div class="text-[11px] font-black text-white">${pin}</div>
        </div>
    </div>
    
    <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-full ${resultBg} flex items-center justify-center ${resultColor}">
            <i class="fa ${resultIcon} text-[10px]"></i>
        </div>
        <div>
            <div class="text-[8px] text-gray-500 font-bold uppercase tracking-[0.2em]">Result</div>
            <div class="text-[11px] font-black uppercase ${resultColor}">${resultStatus}</div>
        </div>
    </div>
    
    <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-full bg-blue-500/10 flex items-center justify-center text-blue-500">
            <i class="fa fa-calendar-alt text-[10px]"></i>
        </div>
        <div>
            <div class="text-[8px] text-gray-500 font-bold uppercase tracking-[0.2em]">Date</div>
            <div class="text-[11px] font-bold text-white uppercase">${scanDate}</div>
        </div>
    </div>
</div>

<div class="glass-card p-8 border border-white/5">
    <div class="hw-label mb-4 text-red-500 font-black">SYSTEM SIGNATURE</div>
    <h2 class="text-3xl font-black mb-10 italic uppercase text-white tracking-tighter">
        ${data.pcName || "UNKNOWN"}
    </h2>
    <div class="space-y-6">
        <div>
            <div class="hw-label"><i class="fab fa-windows text-blue-400"></i> Operating System</div>
            <div class="hw-value">${specs.os || "--"}</div>
        </div>
        <div>
            <div class="hw-label"><i class="fa fa-microchip text-red-400"></i> Processor (CPU)</div>
            <div class="hw-value">${specs.cpu || "--"}</div>
        </div>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <div class="hw-label"><i class="fa fa-memory text-green-400"></i> Physical RAM</div>
                <div class="hw-value">${specs.ram || "--"}</div>
            </div>
            <div>
                <div class="hw-label"><i class="fa fa-clock text-yellow-400"></i> System Uptime</div>
                <div class="hw-value">${specs.boot || "--"}</div>
            </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <div class="hw-label"><i class="fa fa-calendar-check text-cyan-400"></i> Format Date</div>
                <div class="hw-value">${specs.installDate || "Unknown"}</div>
            </div>
            <div>
                <div class="hw-label">
                    <i class="fa fa-shield-virus ${specs.antivirus === 'Active' ? 'text-green-400' : 'text-red-500'}"></i> Antivirus
                </div>
                <div class="hw-value ${specs.antivirus === 'Active' ? 'text-green-400' : 'text-red-500'}">
                    ${specs.antivirus || "Unknown"}
                </div>
            </div>
        </div>
    </div>
</div>

<div class="glass-card p-6 border border-white/5">
<div class="hw-label mb-6 text-gray-400 font-black tracking-widest">SECURITY CLASSIFICATIONS</div>
<div id="cat-list" class="space-y-2">
<div onclick="renderFindings('Critical')" class="cat-item active" id="cat-crit">
<div class="flex items-center gap-3">
<i class="fa fa-biohazard text-red-500"></i>
<span class="cat-name">Critical</span>
</div>
<span class="cat-badge text-red-500">${counts.critical}</span>
</div>
<div onclick="renderFindings('Warning')" class="cat-item" id="cat-warn">
<div class="flex items-center gap-3">
<i class="fa fa-triangle-exclamation text-orange-500"></i>
<span class="cat-name">Warning</span>
</div>
<span class="cat-badge text-orange-500">${counts.warning}</span>
</div>
<div onclick="renderFindings('Suspicious')" class="cat-item" id="cat-suspicious">
<div class="flex items-center gap-3">
<i class="fa fa-eye text-yellow-400"></i>
<span class="cat-name">Suspicious</span>
</div>
<span class="cat-badge text-yellow-400">${counts.suspicious}</span>
</div>
<div onclick="renderFindings('Unsigned Files')" class="cat-item" id="cat-unsigned">
<div class="flex items-center gap-3">
<i class="fa fa-fingerprint text-purple-500"></i>
<span class="cat-name">Unsigned Files</span>
</div>
<span class="cat-badge text-purple-500">${counts.unsigned}</span>
</div>
</div>
</div>
</div>

<div class="col-span-12 lg:col-span-8 flex flex-col gap-6">
<div class="w-full">
<h3 class="text-xl font-black uppercase italic mb-6 flex items-center gap-3 text-white">
<span class="w-8 h-[2px] bg-red-600"></span> Live Analysis Findings
</h3>
<div id="findings-container" class="custom-scrollbar">
<div id="findings-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4 w-full"></div>
</div>
</div>

<div class="glass-card p-6 border border-white/5 mt-2">
<div class="flex justify-between items-center mb-4">
<h3 class="text-sm font-black uppercase italic flex items-center gap-3 text-red-500">
<i class="fa fa-history"></i> Execution Timeline
</h3>
<div class="relative w-64">
<i class="fa fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-[10px]"></i>
<input type="text" id="recent-search" onkeyup="filterRecentTable()" placeholder="SEARCH PROCESS OR PATH..." 
class="w-full bg-black/40 border border-white/10 p-2 pl-8 rounded-lg text-[10px] font-mono outline-none focus:border-red-500 text-white transition-colors">
</div>
</div>
<div class="recent-table-container custom-scrollbar pr-2">
<table class="w-full text-left border-collapse">
<thead>
<tr>
<th class="px-4 py-3 text-[9px] text-gray-500 font-black uppercase tracking-[0.2em] border-b border-white/5">Process Name</th>
<th class="px-4 py-3 text-[9px] text-gray-500 font-black uppercase tracking-[0.2em] border-b border-white/5 text-center">Signed</th>
<th class="px-4 py-3 text-[9px] text-gray-500 font-black uppercase tracking-[0.2em] border-b border-white/5">Source Path</th>
<th class="px-4 py-3 text-[9px] text-gray-500 font-black uppercase tracking-[0.2em] border-b border-white/5 text-right">Last Execution</th>
</tr>
</thead>
<tbody>
${recentData.length > 0 ? recentData.sort((a, b) => new Date(b.lastRun) - new Date(a.lastRun)).map(app => {
    let rawStatus = String(app.status).trim().toUpperCase();
    let statusText = "UNSIGNED";
    let statusColor = "text-orange-500";
    
    if(rawStatus === "TRUE" || rawStatus === "SIGNED" || rawStatus === "SUCCESS") {
        statusColor = "text-green-500";
        statusText = "TRUE";
    } else if(rawStatus === "DELETED" || rawStatus === "NOT FOUND") {
        statusColor = "text-red-500";
        statusText = "DELETED";
    } else if(rawStatus === "INVALID" || rawStatus === "INVALID SIGNATURE") {
        statusColor = "text-yellow-500";
        statusText = "INVALID";
    }

    return `
    <tr class="recent-row table-row-hover border-b border-white/5 transition-colors">
    <td class="px-4 py-3">
    <div class="flex items-center gap-2">
    <i class="fa fa-terminal text-red-500/50 text-[10px]"></i>
    <span class="text-[11px] font-bold text-white">${app.name}</span>
    </div>
    </td>
    <td class="px-4 py-3 text-center">
        <span class="text-[8px] font-black uppercase px-2 py-0.5 rounded border border-white/5 ${statusColor}">
            ${statusText}
        </span>
    </td>
    <td class="px-4 py-3 text-[10px] font-mono text-gray-400 italic break-all">${app.path}</td>
    <td class="px-4 py-3 text-right text-[10px] font-black text-red-400/80">${app.lastRun}</td>
    </tr>`;
}).join('') : `
<tr>
<td colspan="4" class="px-4 py-8 text-center text-[10px] font-bold text-gray-600 uppercase tracking-widest">No recent execution data available</td>
</tr>
`}
</tbody>
</table>
</div>
</div>
</div>
`;

renderFindings('Critical');

document.getElementById('view-list').classList.add('hidden');
document.getElementById('view-detail').classList.remove('hidden');

document.querySelectorAll('.cat-item').forEach(item => {
item.addEventListener('click', function() {
document.querySelectorAll('.cat-item').forEach(i => i.classList.remove('active'));
this.classList.add('active');
});
});
}

async function deleteCurrentScan() {
if(confirm('DELETE RECORD?')) {
await fetch(`${DB_URL}/pins/${openPin}.json`, { method: 'DELETE' });
abortSession();
loadPins();
}
}

function abortSession(push = true) {
if(push) updateRoute();
document.getElementById('view-list').classList.remove('hidden');
document.getElementById('view-detail').classList.add('hidden');
loadPins();
}

function logout() {
localStorage.removeItem('auth_status');
location.reload();
}

async function generatePIN() {
const pin = Math.floor(100000 + Math.random() * 900000).toString();
await fetch(`${DB_URL}/pins/${pin}.json`, {
method: 'PUT',
body: JSON.stringify({
staff: "admin",
timestamp: new Date().toLocaleString(),
pcName: "INITIALIZING..."
})
});
loadPins();
}

window.onload = () => {
if(localStorage.getItem('auth_status') === 'granted')
showMainUI();
};
</script>

</body>
</html>
